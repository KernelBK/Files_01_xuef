package org.smart4j.framework.utils;

import java.net.JarURLConnection;
import java.net.URL;
import java.util.Enumeration;
import java.util.HashSet;
import java.util.Set;
import java.util.jar.JarEntry;
import java.util.jar.JarFile;

/**
 * 类操作 工具
 * @author moveb
 *
 */
public class ClassUtil {

	// 获取类加载器
	public static ClassLoader getClassLoader(){
		return Thread.currentThread().getContextClassLoader();
	}
	public static Class<?> loadClass(String className, 
			boolean isInitialized){
		Class<?> clazz = null;
		try{
			clazz = Class.forName(className, isInitialized, getClassLoader());
		} catch(ClassNotFoundException e){
			e.printStackTrace();
		}
		return clazz;
	}
	/**
	 * 获取指定包下的所有类
	 * @param packageName
	 * @return
	 */
	public static Set<Class<?>> getClassSet(String packageName){
		Set<Class<?>> classSet = new HashSet<Class<?>>();
		try{
			Enumeration<URL> urls = getClassLoader().
					getResources(packageName);
			while(urls.hasMoreElements()){
				URL url = urls.nextElement();
				if(url != null){
					String protocol = url.getProtocol();
					if(protocol.equals("file")){
						String packagePath = url.getPath().
								replaceAll("%20", " ");
						addClass(classSet, packagePath, packageName);
					}else if(protocol.equals("jar")){
						JarURLConnection jarURLConnection = (JarURLConnection) url.openConnection();
						if(jarURLConnection != null){
							JarFile jarFile = jarURLConnection.getJarFile();
							if(jarFile != null){
								Enumeration<JarEntry> jarEntries = jarFile.entries();
								while(jarEntries.hasMoreElements()){
									JarEntry jarEntry = jarEntries.nextElement();
									
									
								}
							}
						}
					}
				}
			}
		
		} catch(){}
		return null;
	}
	private static void addClass(Set<Class<?>> classSet, String packagePath,
			String packageName) {
		// TODO Auto-generated method stub
		
	}
}
