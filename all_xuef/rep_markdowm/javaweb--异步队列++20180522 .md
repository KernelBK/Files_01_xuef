# 异步队列

一旦网站做大了，在网站上的一个小动作，为之要做的事是很多的。

比如一个用户对某文章点了赞。

那是不是要给博主发个站内信？是不是增加博主的成就值？增加帖子或文章的积分？

是不是记录下这个点赞行为，把点赞者与文章关联起来。

表面上看就做了一件事，但是网站背后要做很多很多事情。



再以登录为例。用户只是输入了用户名密码。

网站要做很多事情。

比如有的为用户登录增加积分，记录用户连续登录天数；

如果用户登录IP与之前不同，有可能账号被盗，需要发个提醒给用户。



## 生产者与消费者模型

EventProducer

比如用户提交通过了一道编程题，生成一个事件抛入队列。（单向/优先队列）

EventConsumer

拿到这个事件，询问谁对这个事件感兴趣，排行榜感兴趣，交给排行榜Handler来刷新排行榜。



# 服务化与异步化

对大公司来说，系统越来越复杂。

如果相似的代码（如增加积分）充斥在各处，那很不好管理。

所以大型的系统到后面都是服务化和异步化。把每个模块独立出来做成一个工程，把相应的接口暴露出来给所有业务部门用，所有的服务都单独维护。

在支付宝，大工程中，比如有专门维护用户信息的一个组，他们的任务就是把这个组维护好，并提供接口。

不可能让你随便去读写数据库。



用户点完赞，最关心的是这个赞点成功了，至于后面的积分增加，延迟几秒告诉用户是没关系的。

这就可以异步化。也就是分清事情的轻重缓急。



# 异步IO



# 都是集合，队列，优先队列这些东西





